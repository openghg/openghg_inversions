
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>openghg_inversions.hbmcmc.hbmcmc_post_process &#8212; openghg_inversions  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/openghg_inversions.hbmcmc.hbmcmc_post_process';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="openghg_inversions.hbmcmc.inversion_pymc" href="openghg_inversions.hbmcmc.inversion_pymc.html" />
    <link rel="prev" title="openghg_inversions.hbmcmc.hbmcmc_output" href="openghg_inversions.hbmcmc.hbmcmc_output.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">openghg_inversions  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage/usage.html">
    Using OpenGHG Inversions
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="modules.html">
    openghg_inversions
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage/usage.html">
    Using OpenGHG Inversions
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="modules.html">
    openghg_inversions
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="openghg_inversions.html">openghg_inversions</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="openghg_inversions.basis.html">openghg_inversions.basis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.basis.algorithms.html">openghg_inversions.basis.algorithms</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="openghg_inversions.config.html">openghg_inversions.config</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.config.config.html">openghg_inversions.config.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.config.paths.html">openghg_inversions.config.paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.config.version.html">openghg_inversions.config.version</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="openghg_inversions.hbmcmc.html">openghg_inversions.hbmcmc</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.hbmcmc.components.html">openghg_inversions.hbmcmc.components</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.hbmcmc.hbmcmc.html">openghg_inversions.hbmcmc.hbmcmc</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.hbmcmc.hbmcmc_output.html">openghg_inversions.hbmcmc.hbmcmc_output</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">openghg_inversions.hbmcmc.hbmcmc_post_process</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.hbmcmc.inversion_pymc.html">openghg_inversions.hbmcmc.inversion_pymc</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.hbmcmc.inversionsetup.html">openghg_inversions.hbmcmc.inversionsetup</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.hbmcmc.post_process_inputs.html">openghg_inversions.hbmcmc.post_process_inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.hbmcmc.run_hbmcmc.html">openghg_inversions.hbmcmc.run_hbmcmc</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="openghg_inversions.inversion_data.html">openghg_inversions.inversion_data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.inversion_data.get_data.html">openghg_inversions.inversion_data.get_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.inversion_data.getters.html">openghg_inversions.inversion_data.getters</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.inversion_data.scenario.html">openghg_inversions.inversion_data.scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.inversion_data.serialise.html">openghg_inversions.inversion_data.serialise</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="openghg_inversions.postprocessing.html">openghg_inversions.postprocessing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.postprocessing.countries.html">openghg_inversions.postprocessing.countries</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.postprocessing.diagnostics.html">openghg_inversions.postprocessing.diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.postprocessing.inversion_output.html">openghg_inversions.postprocessing.inversion_output</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.postprocessing.make_outputs.html">openghg_inversions.postprocessing.make_outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.postprocessing.make_paris_outputs.html">openghg_inversions.postprocessing.make_paris_outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.postprocessing.stats.html">openghg_inversions.postprocessing.stats</a></li>
<li class="toctree-l3"><a class="reference internal" href="openghg_inversions.postprocessing.utils.html">openghg_inversions.postprocessing.utils</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="openghg_inversions.array_ops.html">openghg_inversions.array_ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="openghg_inversions.convert.html">openghg_inversions.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="openghg_inversions.filters.html">openghg_inversions.filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="openghg_inversions.model_error.html">openghg_inversions.model_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="openghg_inversions.utils.html">openghg_inversions.utils</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="modules.html" class="nav-link">openghg_inversions</a></li>
    
    
    <li class="breadcrumb-item"><a href="openghg_inversions.html" class="nav-link">openghg_inversions</a></li>
    
    
    <li class="breadcrumb-item"><a href="openghg_inversions.hbmcmc.html" class="nav-link">openghg_inversions.hbmcmc</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">openghg_inversions.hbmcmc.hbmcmc_post_process</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-openghg_inversions.hbmcmc.hbmcmc_post_process">
<span id="openghg-inversions-hbmcmc-hbmcmc-post-process"></span><h1>openghg_inversions.hbmcmc.hbmcmc_post_process<a class="headerlink" href="#module-openghg_inversions.hbmcmc.hbmcmc_post_process" title="Link to this heading">#</a></h1>
<p>Script to process HBMCMC (RHIME) output.</p>
<p>This module includes functions for processing and visualizing HBMCMC inversion results.</p>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h2>
<dl class="simple">
<dt>write_netcdf, append_netcdf</dt><dd><p>Write output to netCDF files.</p>
</dd>
<dt>plot_scaling</dt><dd><p>Plot posterior scaling map.</p>
</dd>
<dt>regions_histogram</dt><dd><p>Plot histogram of number of regions.</p>
</dd>
<dt>country_emissions</dt><dd><p>Calculate emissions from given list of countries.
Currently hard-wired for methane.</p>
</dd>
</dl>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.calculate_DIC">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">calculate_DIC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.calculate_DIC" title="Link to this definition">#</a></dt>
<dd><p>Calculates the Deviance information criterion (DIC) for an inversion.
It does this using two different definitions:
1) Spiegelhalter et al. (2002) <a class="reference external" href="https://doi.org/10.1111/1467-9868.00353">https://doi.org/10.1111/1467-9868.00353</a>
2) Gelman et al. (2004) <a class="reference external" href="http://www.stat.columbia.edu/~gelman/research/published/waic_understand3.pdf">http://www.stat.columbia.edu/~gelman/research/published/waic_understand3.pdf</a>.</p>
<p>The DIC is similar to metrics like AIC (Akaike Information Criterion) but
better suited to hierarchical models and MCMC.
What this is useful for is for testing things such as whether increasing the number of
basis functions improves things, or is it just fitting to the noise and making uncertainty larger.
The lower the DIC the better.
It should be noted that this doesn’t give a hard and fast description of the suitability of a
statistical model but is the most useful indicator I can find.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray dataset</em>) – dataset output from hbmcmc</p></li>
<li><p><strong>silence</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Set to True to not print to screen</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DIC using Spiegelhalter et al. (2002) definition
float : DIC using Gelman et al. (2004) definition</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.check_missing_dates">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">check_missing_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.check_missing_dates" title="Link to this definition">#</a></dt>
<dd><p>Check for missing dates from a list of filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filenames</strong> – List of filenames to check.</p></li>
<li><p><strong>dates</strong> – List of expected dates to check in filenames.</p></li>
<li><p><strong>labels</strong> – List of labels for the dates that do match.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(dates, labels) - List of dates with matching filenames and</dt><dd><p>corresponding list of labels.
labels associated with dates, as specified in input</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.check_platform">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">check_platform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.check_platform" title="Link to this definition">#</a></dt>
<dd><p>This function extracts platform (if specified) for the site from site_info.json file.
network can be specified if site is associated with more than one network. If not
specified, the first network will be used by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site</strong> – Site code (if applicable) or name</p></li>
<li><p><strong>network</strong> – If a site is part of multiple networks, will select a given one and check
the platform</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>platform type (e.g. “site”, “satellite”, “aircraft”) if specified by site_info.json,</dt><dd><p>otherwise None</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.country_emissions">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">country_emissions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_unit_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">countries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.country_emissions" title="Link to this definition">#</a></dt>
<dd><p>Extract individual country emissions from a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> – Output dataset from HBMCMC inversion.</p></li>
<li><p><strong>species</strong> – Species run in the inversion (e.g. ‘hfc23’).</p></li>
<li><p><strong>domain</strong> – Domain over which the inversion was run (e.g. ‘EASTASIA’).</p></li>
<li><p><strong>country_file</strong> – Country file from which to extract country definitions. Defaults to None, in which case
the function looks for it in ‘data/countries/[domain]’ using the utils.get_country function.</p></li>
<li><p><strong>country_unit_prefix</strong> – Prefix for which to report emissions in (e.g. ‘G’ for Gg). Conversion done by convert.prefix.
Defaults to None, in which case emissions are reported in g.</p></li>
<li><p><strong>countries</strong> – Array of country names for which to calculate emissions for. Defaults to None, in which case these
are extracted from the country file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(cntrymean, cntry68, cntry95, cntryprior, cntrymode) where:</dt><dd><ul class="simple">
<li><p>cntrymean: 1D array of mean emissions from each country</p></li>
<li><p>cntry68: 2D array of 68% CI emissions from each country</p></li>
<li><p>cntry95: 2D array of 95% CI emissions from each country</p></li>
<li><p>cntryprior: 1D array of prior emissions from each country</p></li>
<li><p>cntrymode: 1D array of mode emissions from each country</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.country_emissions_mult">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">country_emissions_mult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_unit_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">countries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.country_emissions_mult" title="Link to this definition">#</a></dt>
<dd><p>Calculate country emissions across multiple datasets.</p>
<p>See process.country_emissions() function for details of inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>(cntrymean_arr, cntry68_arr, cntry95_arr, cntryprior_arr) where:</dt><dd><ul class="simple">
<li><p>cntrymean_arr: Array of country means for each ds, with size [number of ds x number of countries]</p></li>
<li><dl class="simple">
<dt>cntry68_arr: Array of 68th percentile upper and lower bounds of country emissions for each ds,</dt><dd><p>with size [number of ds x number of countries x 2]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cntry95_arr: Array of 95th percentile upper and lower bounds of country emissions for each ds,</dt><dd><p>with size [number of ds x number of countries x 2]</p>
</dd>
</dl>
</li>
<li><p>cntryprior_arr: Array of country priors for each ds, with size [number of ds x number of countries].</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.define_stations">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">define_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)"><span class="pre">Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_site_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.define_stations" title="Link to this definition">#</a></dt>
<dd><p>Define latitude and longitude values for each site in a dataset.</p>
<p>The output can be passed directly as the ‘stations’ argument in plot_map.</p>
<p>If sites is not specified, if the platform for the site is listed as “aircraft” or
“satellite” in the site_info.json file then no values are included in the stations
dictionary for this site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> – <p>Output from run_hbmcmc() function.
Expects dataset to contain:</p>
<blockquote>
<div><ul>
<li><p>sitelons: Longitude values for each site. Dimension = len(sites)</p></li>
<li><p>sitelats: Latitude values for each site. Dimension = len(sites)</p></li>
<li><p>y_site: Site identifier for each measurement. Dimension = nmeasure</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>sites</strong> – List of sites to look for within dataset.
If not specified, the sites will be extracted from the input dataset assuming a
data variable “sites” is included within the dataset.</p></li>
<li><p><strong>use_site_info</strong> – Use positions from openghg_defs rather than extract them from the tdmcmc dataset.
Default = False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing sitelats, sitelons for each site.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.extract_hbmcmc_files">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">extract_hbmcmc_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">runname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_filenames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.extract_hbmcmc_files" title="Link to this definition">#</a></dt>
<dd><p>Find hbmcmc output filenames based on naming convention.</p>
<p>Naming convention: “directory”/”species”+”domain”+”runname”_”date”.nc”
Open as xarray.Dataset objects and return as a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> – Path to output directory where hbmcmc files are written.</p></li>
<li><p><strong>species</strong> – Species of inversion (e.g. “hfc23”).</p></li>
<li><p><strong>domain</strong> – Domain of inversion (e.g. “EASTASIA”).</p></li>
<li><p><strong>runname</strong> – Name of run (as specified in .ini file).</p></li>
<li><p><strong>dates</strong> – List of dates of the inversion, as specified at the top of the .ini file and
in the output file name.</p></li>
<li><p><strong>return_filenames</strong> – Whether to return the filenames. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>If return_filenames is True, returns (ds_list, filenames), otherwise just ds_list.</dt><dd><ul class="simple">
<li><p>ds_list: List of xarray datasets matching the input parameters</p></li>
<li><p>filenames: List of filenames (only if return_filenames is True)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.open_ds">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">open_ds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.open_ds" title="Link to this definition">#</a></dt>
<dd><p>Function efficiently opens xr datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – path to xarray dataset</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dataset</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.plot_abs_map">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">plot_abs_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergeCentre=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.LinearSegmentedColormap</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borders=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_stations=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_site_info=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend='both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_data_var='fluxmode'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_abs_map" title="Link to this definition">#</a></dt>
<dd><p>Plot 2D map(s) of posterior x in g/m2/s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds_list</strong> – <p>List of xarray.Dataset objects. Each dataset is an output from run_tdmcmc()
function (tdmcmc_inputs.py script).
Expects each data set to contain:</p>
<blockquote>
<div><ul>
<li><p>x_post_vit: posterior values for each iteration flattened along lat-lon axis.
Dimensions = nIt x NGrid (nlat x nlon)</p></li>
<li><p>q_ap: a priori flux values on a latitude x longitude grid.
Dimensions = nlat x nlon</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>lat</strong> – Data array of lat values to plot over - must match values in ds exactly.</p></li>
<li><p><strong>lon</strong> – Data array of lon values to plot over - must match values in ds exactly.</p></li>
<li><p><strong>species</strong> – Species for the tdmcmc output.</p></li>
<li><p><strong>grid</strong> – Whether to plot the posterior on one figure as a grid or on individual plots.</p></li>
<li><p><strong>labels</strong> – Can specify either one label for all plots (str) or a different label for
each plot.
If list is specified, it must match number of datasets in ds_list.</p></li>
<li><p><strong>plot_stations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Plot site positions on the output map. Will not plot aircraft or satellite positions.</p></li>
<li><p><strong>use_site_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If plotting site positions, use positions from site_info.json file rather
than extract them from the tdmcmc dataset.
Default = False.</p></li>
<li><p><strong>flux_data_var</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Which measure of flux distribution (i.e. mode) to plot. Defaults to ‘fluxmode’, which is the only one
in the output files currently</p></li>
<li><p><strong>inputs.</strong> (<em>See plot_map</em><em>(</em><em>) </em><em>function for definition</em><em> of </em><em>remaining</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>None</p>
<dl class="simple">
<dt>If out_filename specified:</dt><dd><p>Plot is written to file</p>
</dd>
<dt>Otherwise:</dt><dd><p>Plot is displayed interactively</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.plot_country_timeseries">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">plot_country_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">country_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_CI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Posterior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'emissions'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'g'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">3)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_country_timeseries" title="Link to this definition">#</a></dt>
<dd><p>Plot  timeseries of country emissions. Requires more than one time stamp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>country_mean</strong> (<em>data array</em>) – A 1D array of emissions over time</p></li>
<li><p><strong>country_CI</strong> (<em>data array</em>) – A 2D array of upper and lower bounds of emissions over time</p></li>
<li><p><strong>country_prior</strong> (<em>data array</em>) – A 1D array of prior emissions over time</p></li>
<li><p><strong>d0</strong> (<em>data array</em>) – 1D array of time stamps. Must match the length of country_mean, country_CI and country_prior</p></li>
<li><p><strong>country_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Label for the country being plotted. Defaults to empty string</p></li>
<li><p><strong>prior_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Label for the prior emissions. Defaults to “Prior”</p></li>
<li><p><strong>posterior_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Label for the posterior emissions. Defaults to “Posterior”</p></li>
<li><p><strong>y_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Label for the y-axis (which is labelled [country_label] [y_label]). Defaults to “emissions”</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Units for labelling of y-axis. Defaults to “g”</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Size of figure. Defaults to (7,3).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.plot_diff_map">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">plot_diff_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergeCentre=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centre_zero=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.LinearSegmentedColormap</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borders=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_stations=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_site_info=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend='both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_data_var='fluxmode'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_diff_map" title="Link to this definition">#</a></dt>
<dd><p>Plot 2D map(s) of the difference between the prior and posterior x in g/m2/s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds_list</strong> – <p>List of xarray.Dataset objects. Each dataset is an output from run_tdmcmc()
function (tdmcmc_inputs.py script).
Expects each data set to contain:</p>
<blockquote>
<div><ul>
<li><p>x_post_vit: posterior values for each iteration flattened along lat-lon axis.
Dimensions = nIt x NGrid (nlat x nlon)</p></li>
<li><p>q_ap: a priori flux values on a latitude x longitude grid.
Dimensions = nlat x nlon</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>lat</strong> – Data array of lat values to plot over - must match values in ds exactly.</p></li>
<li><p><strong>lon</strong> – Data array of lon values to plot over - must match values in ds exactly.</p></li>
<li><p><strong>species</strong> – Species for the tdmcmc output.</p></li>
<li><p><strong>grid</strong> – Whether to plot the posterior on one figure as a grid or on individual plots.</p></li>
<li><p><strong>labels</strong> (<em>str/list</em>) – Can specify either one label for all plots (str) or a different label for
each plot.
If list is specified, it must match number of datasets in ds_list.</p></li>
<li><p><strong>plot_stations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Plot site positions on the output map. Will not plot aircraft or satellite positions.</p></li>
<li><p><strong>use_site_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If plotting site positions, use positions from site_info.json file rather
than extract them from the tdmcmc dataset.
Default = False.</p></li>
<li><p><strong>flux_data_var</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Which measure of flux distribution (i.e. mode) to plot. Defaults to ‘fluxmode’, which is the only one
in the output files currently</p></li>
<li><p><strong>inputs.</strong> (<em>See plot_map</em><em>(</em><em>) </em><em>function for definition</em><em> of </em><em>remaining</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>None</p>
<dl class="simple">
<dt>If out_filename specified:</dt><dd><p>Plot is written to file</p>
</dd>
<dt>Otherwise:</dt><dd><p>Plot is displayed interactively</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.plot_map">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergeCentre=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.LinearSegmentedColormap</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borders=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend='both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show=True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_map" title="Link to this definition">#</a></dt>
<dd><p>Plot 2D map of data.</p>
<p>e.g. scaling map of posterior x i.e. degree of scaling applied to prior emissions.
Mainly used within the wrappers of plot_abs_map, plot_diff_map etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 2D (lat,lon) array of whatever you want.</p></li>
<li><p><strong>lon</strong> – Longitude array matching to data grid.</p></li>
<li><p><strong>lat</strong> (<em>numpy.array</em>) – Latitude array  matching to data grid</p></li>
<li><p><strong>clevels</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – Array of contour levels; if None, uses the set_clevels function</p></li>
<li><p><strong>divergeCentre</strong> (<em>float/None</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Default is None, to replicate original clevels behaviour.</dt><dd><p>If given a float, this value is used to manually set the centre value of a diverging cmap,
while using the min and max values of clevels as the min and max values of the cmap.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib.cm</em><em>, </em><em>optional</em>) – Colormap object; defaults to Red Blue reverse (plt.cm.RdBu_r)</p></li>
<li><p><strong>borders</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Add country borders as well as coastlines. Default = True.</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Label to appear underneath the colorbar. Default = None</p></li>
<li><p><strong>smooth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True plot smooth contours; otherwise use pcolormesh. Default = False.</p></li>
<li><p><strong>out_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Output filename. If this is specified the plot will be written to file.
Will be shown interactively otherwise (if show=True). Default = None.</p></li>
<li><p><strong>stations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Default is None. If specified needs to be a dictionary containing the list of sites
and site locations for each site. For example:</p>
<p>{“sites”: [‘MHD’, ‘TAC’], “MHDlons”: -9.02, “MHDlats”: 55.2, “TAClons”: etc…}</p>
<p>This is the default output from the define_stations function, but can’t default to this
as the data argument doesn’t have a sitenames attribute</p>
</p></li>
<li><p><strong>fignum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Figure number for created plot. Default = None</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Title for the plot or sub-plot. Default = None</p></li>
<li><p><strong>extend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Extend colorbar for out-of-range values.
Options are [ ‘neither’ | ‘both’ | ‘min’ | ‘max’ ]
Default = “both”. Set to “neither” to not extend.</p></li>
<li><p><strong>figsize</strong> (<em>tuple/None</em><em>, </em><em>optional</em>) – Figure size tuple if creating a new fig object.
Default = None.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.Figure</em><em>, </em><em>optional</em>) – Figure object for plot. If not specified this will be created. Default = None</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em><em>, </em><em>optional</em>) – Axes object for plot domain. If not specified this will be created. Default = None</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to plot immediately upon completion of plotting within this function.
Note that out_filename supercedes this option and plot will be written to file even
if this is set to True.
Default = True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>None</p>
<dl class="simple">
<dt>If out_filename is None:</dt><dd><p>Created plot is saved to file</p>
</dd>
<dt>Else:</dt><dd><p>Plot is displayed interactively</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.plot_map_mult">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">plot_map_mult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot='auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergeCentre=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centre_zero=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.LinearSegmentedColormap</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borders=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend='both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_map_mult" title="Link to this definition">#</a></dt>
<dd><p>Use plot_map function to plot a set of maps either on a grid or as separate figures.</p>
<p>If plotting on a grid the subplots are either determined automatically based on shape of
input or using subplot input.</p>
<dl class="simple">
<dt>Expect data_all to either be:</dt><dd><ul class="simple">
<li><p>a numpy.array of the shape: nlat x nlon (x ngrid)</p></li>
<li><p>list of numpy.array objects each of shape nlat x nlon.</p></li>
</ul>
</dd>
</dl>
<p>Either the ngrid dimension or the len of the list is taken as the number of panels to
include on the plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_all</strong> – Multiple lat-lon grids to be plotted on one figure as a set of sub-plots or as
multiple figures. Can either be a list of grids or an array of dimension nlat x nlon (x ngrid).</p></li>
<li><p><strong>lon</strong> – Longitude array matching to longitude points in each grid in grid_data.</p></li>
<li><p><strong>lat</strong> – Latitude array matching to longitude points in each grid in grid_data.</p></li>
<li><p><strong>grid</strong> – Whether to plot on a grid. Default = True.</p></li>
<li><p><strong>subplot</strong> – If grid is True, subplot grid to use. If this is set to “auto” this will be
automatically determined based on the size of ngrid (see subplot_fmt() function).
Otherwise, this should be a two item list of [nrows, ncols]. Default = “auto”.</p></li>
<li><p><strong>labels</strong> – Can specify either one label for all plots (str) or a different label for
each plot as a list. If list is specified, it must match ngrid length.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See plot_map() function for definition of remaining inputs.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None. If out_filename specified, plot is written to file. Otherwise, plot is displayed interactively.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.plot_multi_country_timeseries">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">plot_multi_country_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">countries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">country_unit_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">3)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_multi_country_timeseries" title="Link to this definition">#</a></dt>
<dd><p>Plot country emissions timeseries for given inversions and specified countries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – list of RHIME hbmcmc output datasets</p></li>
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – species for which the inversion was run</p></li>
<li><p><strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – domain over which the inversion was run</p></li>
<li><p><strong>countries</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – list of countries to plot (must be in countryfile)</p></li>
<li><p><strong>country_file</strong> (<em>filepath</em>) – country file</p></li>
<li><p><strong>d0</strong> (<em>array</em>) – 1D array of dates corresponding to the ds_list</p></li>
<li><p><strong>country_unit_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – prefix for which to report emissions in (e.g. ‘G’ for Gg). Conversion done by convert.prefix.
Defaults to None, in which case emissions are reported in g</p></li>
<li><p><strong>plot_prior</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether to plot the prior emissions. defaults to True</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – figure size (defaults to (7,3))</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.plot_scale_map">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">plot_scale_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergeCentre=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centre_zero=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.LinearSegmentedColormap</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borders=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_stations=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_site_info=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend='both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_scale_map" title="Link to this definition">#</a></dt>
<dd><p>Plot 2D scaling map(s) of posterior x.</p>
<p>This is the degree of scaling which has been applied to prior emissions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds_list</strong> – <p>List of xarray.Dataset objects. Each dataset is an output from run_tdmcmc()
function (tdmcmc_inputs.py script).
Expects each data set to contain:</p>
<blockquote>
<div><ul>
<li><p>x_post_vit: posterior values for each iteration flattened along lat-lon axis.
Dimensions = nIt x NGrid (nlat x nlon)</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>lat</strong> – Data array of lat values to plot over - must match values in ds exactly.</p></li>
<li><p><strong>lon</strong> – Data array of lon values to plot over - must match values in ds exactly.</p></li>
<li><p><strong>grid</strong> – Whether to plot the posterior on one figure as a grid or on individual plots.</p></li>
<li><p><strong>labels</strong> – Can specify either one label for all plots (str) or a different label for
each plot. If list is specified, it must match number of datasets in ds_list.</p></li>
<li><p><strong>plot_stations</strong> – Whether to plot station locations.
Plot site positions on the output map. Will not plot aircraft or satellite positions.</p></li>
<li><p><strong>use_site_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If plotting site positions, use positions from site_info.json file rather
than extract them from the tdmcmc dataset.
Default = False.</p></li>
<li><p><strong>inputs.</strong> (<em>See plot_map</em><em>(</em><em>) </em><em>function for definition</em><em> of </em><em>remaining</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>None</p>
<dl class="simple">
<dt>If out_filename specified:</dt><dd><p>Plot is written to file</p>
</dd>
<dt>Otherwise:</dt><dd><p>Plot is displayed interactively</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.plot_timeseries">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">plot_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bc_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_timeseries" title="Link to this definition">#</a></dt>
<dd><p>Plot measurement timeseries of posterior and observed measurements
Requires post_mcmc xr dataset. Can plot to console or save to file.
Plots 95% CI by default.
For future: incorporate model &amp; measurement uncertainty
Plots separate subplots for each of the measurement sites - hopefully!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray dataset</em>) – dataset output from run_tdmcmc script</p></li>
<li><p><strong>fig_text</strong> (<em>String</em>) – e.g. “CH$_{4}$ mole fraction (ppb)”. Defaults to None</p></li>
<li><p><strong>ylim</strong> (<em>array</em>) – y-axis limits [ymin,ymax]. If not specified, set automatically</p></li>
<li><p><strong>out_filename</strong> (<em>string</em>) – Filename to save file, if specified. Defaults to None (figure isn’t saved)</p></li>
<li><p><strong>doplot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Plot to console? (optional, defaults to True)</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Specify size of figure as a two-item tuple.</p></li>
<li><p><strong>plot_prior</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Plot mole fraction prior.</p></li>
<li><p><strong>plot_bc_prior</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Plot inner boundary conditions prior.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.set_clevels">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">set_clevels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centre_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">above_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.set_clevels" title="Link to this definition">#</a></dt>
<dd><p>The set_clevels function defines a set of contour levels for plotting based on the inputs
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>iterable</em>) – Data which will be plotted.</p></li>
<li><p><strong>num_tick</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of ticks on axis within levels.
Either this or tick should be specified.
Default = 20</p></li>
<li><p><strong>tick</strong> (<em>int/None</em>) – Tick interval to use between minimum and maximum data values.
Either this or num_tick should be specified.
Default = None i.e. use num_tick rather than set an explicit tick interval</p></li>
<li><p><strong>centre_zero</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Explictly centre levels around zero.
Default = False.</p></li>
<li><p><strong>above_zero</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Explicitly set clevels based on percentiles of positive data only.
Default = False</p></li>
<li><p><strong>rescale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Rescale according to the most appropriate unit.
This will rescale based on 10^3 and return the scaling factor used.
Default = False</p></li>
<li><p><strong>robust</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Based on xarray plotting. This finds the 2nd and 98th percentiles (rather
than min and max) to account for any outliers which would cause the range to
be too large.
Default = False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of levels values based on min and max of input data.
Also returns scaling factor if rescale=True.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array[,<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.subplot_fmt">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">subplot_fmt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[3,</span> <span class="pre">2,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.subplot_fmt" title="Link to this definition">#</a></dt>
<dd><p>Decide the placement of a grid of figures dependent on the number.</p>
<p>The row_dims input determines which placement is preferable for the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> – Number of figures to be placed.</p></li>
<li><p><strong>row_dims</strong> – <p>Row dimensions in order of preference.
For the default row_dims=[3,2,4] the preferences of placement is as follows:</p>
<blockquote>
<div><ul>
<li><p>equal rows of 3</p></li>
<li><p>equal rows of 2</p></li>
<li><p>equal rows of 4</p></li>
</ul>
</div></blockquote>
<p>If none of the above are possible the format will be num x number of columns if fill
is True or the configuration suitable for num+1 if fill is False.</p>
</p></li>
<li><p><strong>fill</strong> – All panels in subplot must be filled. If not, for uneven numbers an extra panel will
be added which will be left blank when plotting.
Default = False (i.e. allow an empty panel to be included within subplot).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2 item tuple containing the row number and column number for the subplots.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openghg_inversions.hbmcmc.hbmcmc_post_process.unbiasedDivergingCmap">
<span class="sig-prename descclassname"><span class="pre">openghg_inversions.hbmcmc.hbmcmc_post_process.</span></span><span class="sig-name descname"><span class="pre">unbiasedDivergingCmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minValue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxValue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.unbiasedDivergingCmap" title="Link to this definition">#</a></dt>
<dd><p>Calculate the normalisation of a diverging cbar around a given value.</p>
<p>Prevents bias due to asymmetry in data affecting scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array of data to plot</p></li>
<li><p><strong>zero</strong> – the centre value of the cmap</p></li>
<li><p><strong>minValue</strong> – smallest value to use in calculation</p></li>
<li><p><strong>maxValue</strong> – largest value to use in calculation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a normalization function to be fed into plot</p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="openghg_inversions.hbmcmc.hbmcmc_output.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">openghg_inversions.hbmcmc.hbmcmc_output</p>
      </div>
    </a>
    <a class="right-next"
       href="openghg_inversions.hbmcmc.inversion_pymc.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">openghg_inversions.hbmcmc.inversion_pymc</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.calculate_DIC"><code class="docutils literal notranslate"><span class="pre">calculate_DIC()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.check_missing_dates"><code class="docutils literal notranslate"><span class="pre">check_missing_dates()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.check_platform"><code class="docutils literal notranslate"><span class="pre">check_platform()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.country_emissions"><code class="docutils literal notranslate"><span class="pre">country_emissions()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.country_emissions_mult"><code class="docutils literal notranslate"><span class="pre">country_emissions_mult()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.define_stations"><code class="docutils literal notranslate"><span class="pre">define_stations()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.extract_hbmcmc_files"><code class="docutils literal notranslate"><span class="pre">extract_hbmcmc_files()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.open_ds"><code class="docutils literal notranslate"><span class="pre">open_ds()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_abs_map"><code class="docutils literal notranslate"><span class="pre">plot_abs_map()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_country_timeseries"><code class="docutils literal notranslate"><span class="pre">plot_country_timeseries()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_diff_map"><code class="docutils literal notranslate"><span class="pre">plot_diff_map()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_map"><code class="docutils literal notranslate"><span class="pre">plot_map()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_map_mult"><code class="docutils literal notranslate"><span class="pre">plot_map_mult()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_multi_country_timeseries"><code class="docutils literal notranslate"><span class="pre">plot_multi_country_timeseries()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_scale_map"><code class="docutils literal notranslate"><span class="pre">plot_scale_map()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.plot_timeseries"><code class="docutils literal notranslate"><span class="pre">plot_timeseries()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.set_clevels"><code class="docutils literal notranslate"><span class="pre">set_clevels()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.subplot_fmt"><code class="docutils literal notranslate"><span class="pre">subplot_fmt()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#openghg_inversions.hbmcmc.hbmcmc_post_process.unbiasedDivergingCmap"><code class="docutils literal notranslate"><span class="pre">unbiasedDivergingCmap()</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/openghg_inversions.hbmcmc.hbmcmc_post_process.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Eric Saboya and Brendan Murphy.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>